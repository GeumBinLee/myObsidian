> [!Info]- ì¶œì²˜ ë§í¬
> [ğŸ”— Flutter Zero to Hero.Part 3 ğŸ”—](https://medium.com/@NALSengineering/flutter-from-zero-to-hero-part-3-understand-buildcontext-in-4-minutes-472af1df8e02)

> [!Question] í•™ìŠµ ëª©í‘œ
> ëª¨ë“  `build` í•¨ìˆ˜ì— ì¡´ì¬í•˜ëŠ” `BuildContext context` ë§¤ê°œë³€ìˆ˜ëŠ” ë¬´ì—‡ì´ê³ , ë¬´ì—‡ì„ ìœ„í•´ ì‚¬ìš©í•˜ëŠ” ê±¸ê¹Œ?

# Scenario
```dart
import 'package:flutter/material.dart';

// FloatingActionButtonì„ ëˆ„ë¥´ë©´ ê¸€ìê°€ ì“°ì—¬ì§„ í•˜ë‹¨ ì‹œíŠ¸ê°€(bottom sheet) ë‚˜ì™€ì•¼ í•œë‹¤.
void main() {
  runApp(
    MaterialApp(
      home: MyHomePage(),
    ),
  );
}

class MyHomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      floatingActionButton: FloatingActionButton(onPressed: () {
        /* í•˜ë‹¨ ì‹œíŠ¸ë¥¼ ë³´ì—¬ì£¼ëŠ” ë¶€ë¶„. í•˜ì§€ë§Œ ë²„íŠ¼ í´ë¦­ ì‹œ ì—ëŸ¬ê°€ ëœ¨ë©° ì‘ë™í•˜ì§€ ì•ŠëŠ”ë‹¤.
        Scaffold.of() called with a context that does not contain a Scaffold.
        No Scaffold ancestor could be found starting from the context
        that was passed to Scaffold.of() */
        Scaffold.of(context).showBottomSheet(
          (context) => const Text('Flutter From Zero to Hero'),
        );
      }),
    );
  }
}
```
- `Scaffold.of(context)` : ì´ í•¨ìˆ˜ëŠ” `context` ë³€ìˆ˜ë¥¼ ë°›ì•„ `Scaffold` íƒ€ì… ìœ„ì ¯ ì¤‘ ê°€ì¥ ê°€ê¹Œìš´ ë¶€ëª¨ ìœ„ì ¯ì„ ì°¾ì•„ë‚¸ë‹¤.
- ìœ„ ì½”ë“œëŠ” ë²”ìœ„ ë‚´ì— `Scaffold`ê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸° ë•Œë¬¸ì— exceptionì„ throwí•œ ê²ƒì´ë‹¤.
- ì¦‰ ìš°ë¦¬ê°€ ì˜ëª»ëœ `context`ë¥¼ ì‚¬ìš©í•´ì„œ exceptionì´ ì¼ì–´ë‚œ ê²ƒì´ë‹¤.
# What is BuildContext?
- `BuildContext`ëŠ” í”ŒëŸ¬í„°ê°€ ëª¨ë“  ìœ„ì ¯ì˜ ìœ„ì ¯ íŠ¸ë¦¬ ë‚´ ìœ„ì¹˜ë¥¼ ì•Œ ìˆ˜ ìˆë„ë¡ ë•ëŠ”ë‹¤.
- ì•ì„œ ë°°ì› ë“¯ ëª¨ë“  ìœ„ì ¯ì€ `build` í•¨ìˆ˜ë¥¼ ê°€ì§„ë‹¤.
- ê·¸ë¦¬ê³  ëª¨ë“  `build` í•¨ìˆ˜ëŠ” `BuildContext`ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ì¸ìë¡œ ê°–ëŠ”ë‹¤.
- ì¦‰ **ëª¨ë“  ìœ„ì ¯ì€ ìœ„ì ¯ íŠ¸ë¦¬ ë‚´ì—ì„œ í•´ë‹¹ ìœ„ì ¯ì˜ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚´ëŠ” `BuildContext` ì¸ìŠ¤í„´ìŠ¤ë¥¼ ê°–ëŠ”ë‹¤.**

# Widget Tree
- ìœ„ì ¯ íŠ¸ë¦¬ëŠ” ìœ„ì ¯ì´ ì„œë¡œ ìƒëŒ€ì ìœ¼ë¡œ ì–´ë–»ê²Œ ë°°ì¹˜ë˜ëŠ”ì§€(positioned)ë¥¼ ë³´ì—¬ì¤€ë‹¤.
- ìœ„ ì˜ˆì œ ì½”ë“œëŠ” ì•„ë˜ ì´ë¯¸ì§€ì™€ ê°™ì€ ìœ„ì ¯ íŠ¸ë¦¬ ëª¨ì–‘ì„ í•˜ê³  ìˆë‹¤.
	![[ìœ„ì ¯ íŠ¸ë¦¬ ì˜ˆì‹œ 1.png|center|600]]
- `BuildContext` ê°ì²´ê°€ ìœ„ì ¯ íŠ¸ë¦¬ ë‚´ ìœ„ì ¯ì˜ ìœ„ì¹˜ë¥¼ ë‚˜íƒ€ë‚¸ë‹¤.
- MyHomePageì˜ ì»¨í…ìŠ¤íŠ¸ë¥¼ Scaffold.of í•¨ìˆ˜ì— ì „ë‹¬í•˜ë©´, MyHomePageì˜ ëª¨ë“  ë¶€ëª¨ë¥¼ ìŠ¤ìº”í•˜ê¸° ì‹œì‘í•œë‹¤.
- ê·¸ëŸ¬ë‚˜ ì´ ê²½ìš° ì°¾ì„ ìˆ˜ ìˆëŠ” ìœ ì¼í•œ ë¶€ëª¨ê°€ `Scaffold`ê°€ ì•„ë‹Œ `MaterialApp`ì´ë¼ì„œ ì˜ˆì™¸ê°€ ë°œìƒí•œ ê²ƒì´ë‹¤.
# Fixing the bug: ì˜¬ë°”ë¥¸ `context`ë¥¼ ë„˜ê²¨ë³´ì!
```dart
import 'package:flutter/material.dart';

void main() {
  runApp(
    MaterialApp(
      home: MyHomePage(),
    ),
  );
}

class MyHomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    // FloatingActionButtonì´ ìˆëŠ” MyButtonWidgetì˜ ë¶€ëª¨ì— Scaffoldê°€ ìƒê²¼ë‹¤.
    // ë”°ë¼ì„œ ì´ì œ ë¶€ëª¨ ìœ„ì ¯ ì¤‘ ê°€ì¥ ê°€ê¹Œìš´ Scaffold ì¡°ìƒì„ ì°¾ì„ ìˆ˜ ìˆê²Œ ë˜ì—ˆë‹¤.
    return Scaffold(
      floatingActionButton: MyButtonWidget(),
    );
  }
}

// MyHomePageì˜ contextê°€ ì•„ë‹Œ ìƒˆë¡œ ë§Œë“  MyButtonWidgetì˜ contextë¥¼ ì“°ê¸° ìœ„í•´
// FloatingActionButtonì„ ë³„ë„ì˜ í´ë˜ìŠ¤(MyButtonWidget)ë¡œ ë¶„ë¦¬í•œë‹¤.
class MyButtonWidget extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return FloatingActionButton(onPressed: () {
      Scaffold.of(context).showBottomSheet(
        (context) => Text('Flutter From Zero to Hero'),
      );
    });
  }
}
```
![[ìœ„ì ¯ íŠ¸ë¦¬ ì˜ˆì‹œ 2.png|center|500]]
```dart
// ì•„ë‹ˆë©´ ì•„ë˜ì²˜ëŸ¼ Builder()ë¥¼ ì´ìš©í•´ ì½”ë“œë¥¼ ê°„ëµí™”í•  ìˆ˜ë„ ìˆë‹¤.
void main() {
  runApp(
    MaterialApp(
      home: MyHomePage(),
    ),
  );
}

class MyHomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      // Builder ìœ„ì ¯ì€ ë³¸ì¸ì´ ê°€ì§„ contextë¥¼ Scaffold.ofì— ì „ë‹¬í•œë‹¤.
      floatingActionButton: Builder(builder: (context) {
        return FloatingActionButton(onPressed: () {
          Scaffold.of(context).showBottomSheet(
            (context) => Text('Flutter From Zero to Hero'),
          );
        });
      }),
    );
  }
}
```
![[ìœ„ì ¯ íŠ¸ë¦¬ ì˜ˆì‹œ 3.png|center|500]]

# Builder ìœ„ì ¯
- `Builder` ìœ„ì ¯ì€ **ìƒˆë¡œìš´ `BuildContext`ë¥¼ ìƒì„±**í•˜ê¸° ìœ„í•´ ì‚¬ìš© í•œë‹¤.    
    - Flutter ìœ„ì ¯ íŠ¸ë¦¬ì˜ `BuildContext`ëŠ” ë¶€ëª¨ ìœ„ì ¯ì—ì„œ íŒŒìƒëœë‹¤.
    - í•˜ì§€ë§Œ, íŠ¹ì • ìœ„ì ¯ íŠ¸ë¦¬ ì•ˆì—ì„œ ìƒˆ ì»¨í…ìŠ¤íŠ¸ê°€ í•„ìš”í•  ë•Œê°€ ìˆë‹¤.
    - ì˜ˆë¥¼ ë“¤ì–´, `Scaffold.of(context)` ë˜ëŠ” `Theme.of(context)` ê°™ì€ ë©”ì„œë“œëŠ” í•´ë‹¹ ì»¨í…ìŠ¤íŠ¸ê°€ `Scaffold`ë‚˜ `Theme`ì˜ ìì‹ì´ì–´ì•¼ ì‘ë™í•œë‹¤.
    - í•˜ì§€ë§Œ ë¶€ëª¨ ì»¨í…ìŠ¤íŠ¸ì—ì„œëŠ” ì´ë¥¼ ì°¸ì¡°í•  ìˆ˜ ì—†ëŠ” ê²½ìš°ê°€ ìˆë‹¤.
- ì£¼ë¡œ íŠ¹ì • ìœ„ì ¯ íŠ¸ë¦¬ì—ì„œ ìƒìœ„ `BuildContext`ì™€ ë¶„ë¦¬ëœ ìƒˆë¡œìš´ ì»¨í…ìŠ¤íŠ¸ë¥¼ í•„ìš”ë¡œ í•  ë•Œ ì‚¬ìš©ëœë‹¤.
    - íŠ¹ì • ìœ„ì ¯ì—ì„œ ë¶€ëª¨ì˜ ì»¨í…ìŠ¤íŠ¸ì— ì˜í–¥ì„ ì£¼ì§€ ì•Šê³  í•˜ìœ„ ìœ„ì ¯ íŠ¸ë¦¬ë¥¼ ë Œë”ë§í•˜ê³ ì í•  ë•Œ ì‚¬ìš©
- ì˜ˆì‹œ1: `Scaffold.of(context)` ì‚¬ìš©
    - `caffold.of(context)`ëŠ” ìœ„ì ¯ íŠ¸ë¦¬ê°€ `Scaffold` ì•„ë˜ì— ìˆëŠ” `BuildContext`ì—ì„œë§Œ í˜¸ì¶œ ê°€ëŠ¥í•˜ë‹¤.
    - í•˜ì§€ë§Œ íŠ¸ë¦¬ ìƒë‹¨ì—ì„œ ì ‘ê·¼í•˜ë ¤ í•˜ë©´ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤. ì´ ê²½ìš° `Builder`ë¥¼ ì‚¬ìš©í•˜ì—¬ í•´ê²°í•  ìˆ˜ ìˆë‹¤.
    ```dart
    import 'package:flutter/material.dart';
    
    void main() {
      runApp(MyApp());
    }
    
    class MyApp extends StatelessWidget {
      @override
      Widget build(BuildContext context) {
        return MaterialApp(
          home: Scaffold(
            appBar: AppBar(title: Text("Builder Example")),
            body: Center(
              child: Builder(
                builder: (context) {
                  return ElevatedButton(
                    onPressed: () {
                      // Scaffold.of(context)ëŠ” Builder ì•ˆì—ì„œë§Œ ì•ˆì „í•˜ê²Œ í˜¸ì¶œ ê°€ëŠ¥
                      ScaffoldMessenger.of(context).showSnackBar(
                        SnackBar(content: Text("Hello from Builder!")),
                      );
                    },
                    child: Text("Show SnackBar"),
                  );
                },
              ),
            ),
          ),
        );
      }
    }
    
    ```
    - `Builder`ëŠ” ìƒˆë¡œìš´ `BuildContext`ë¥¼ ìƒì„±í•˜ë©°, ì´ ì»¨í…ìŠ¤íŠ¸ëŠ” `Scaffold` ìœ„ì ¯ì˜ í•˜ìœ„ì— ìœ„ì¹˜í•˜ê²Œ ëœë‹¤.
    - ë”°ë¼ì„œ `Scaffold.of(context)`ë¥¼ ì•ˆì „í•˜ê²Œ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤.
- ì˜ˆì‹œ2: `Theme.of(context)` ì‚¬ìš©    
    - ë§ˆì°¬ê°€ì§€ë¡œ `Theme.of(context)`ë„ í˜„ì¬ ì»¨í…ìŠ¤íŠ¸ê°€ `Theme`ì˜ í•˜ìœ„ì— ìˆì–´ì•¼ ì œëŒ€ë¡œ ì‘ë™í•œë‹¤.
    - `Builder`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì´ë¥¼ ë³´ì¥í•  ìˆ˜ ìˆë‹¤.    
    ```dart
    import 'package:flutter/material.dart';
    
    void main() {
      runApp(MyApp());
    }
    
    class MyApp extends StatelessWidget {
      @override
      Widget build(BuildContext context) {
        return MaterialApp(
          theme: ThemeData(primarySwatch: Colors.blue),
          home: Scaffold(
            appBar: AppBar(title: Text("Builder Example")),
            body: Center(
              child: Builder(
                builder: (context) {
                  return Text(
                    "Primary Color: ${Theme.of(context).primaryColor}",
                    style: TextStyle(fontSize: 18),
                  );
                },
              ),
            ),
          ),
        );
      }
    }
    
    ```
    - `Builder`ë¡œ ìƒˆë¡œìš´ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•˜ë©´, í•´ë‹¹ ì»¨í…ìŠ¤íŠ¸ëŠ” `Theme` ìœ„ì ¯ì˜ í•˜ìœ„ì— ìœ„ì¹˜í•˜ê²Œ ëœë‹¤.
    - ì´ë¡œ ì¸í•´ `Theme.of(context)`ë¥¼ ë¬¸ì œì—†ì´ í˜¸ì¶œí•  ìˆ˜ ìˆë‹¤/
- ë³µì¡í•œ ìœ„ì ¯ íŠ¸ë¦¬ì—ì„œ ì»¨í…ìŠ¤íŠ¸ ê´€ë¦¬
    - ìœ„ì ¯ íŠ¸ë¦¬ê°€ ë³µì¡í•˜ê±°ë‚˜ `BuildContext`ê°€ ì¤‘ì²©ëœ êµ¬ì¡°ì—ì„œëŠ” íŠ¹ì • ì»¨í…ìŠ¤íŠ¸ì— ì ‘ê·¼í•˜ëŠ” ë° ì–´ë ¤ì›€ì´ ìˆì„ ìˆ˜ ìˆë‹¤.
    - ì´ë•Œ `Builder`ë¥¼ ì‚¬ìš©í•˜ì—¬ ëª…ì‹œì ìœ¼ë¡œ ì»¨í…ìŠ¤íŠ¸ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤.    
    ```dart
    import 'package:flutter/material.dart';
    
    void main() {
      runApp(MyApp());
    }
    
    class MyApp extends StatelessWidget {
      @override
      Widget build(BuildContext context) {
        return MaterialApp(
          home: MyHomePage(),
        );
      }
    }
    
    class MyHomePage extends StatelessWidget {
      @override
      Widget build(BuildContext context) {
        return Scaffold(
          appBar: AppBar(title: Text("Nested Builder Example")),
          body: Builder(
            builder: (outerContext) {
              return Center(
                child: ElevatedButton(
                  onPressed: () {
                    ScaffoldMessenger.of(outerContext).showSnackBar(
                      SnackBar(content: Text("SnackBar from outer Builder!")),
                    );
                  },
                  child: Text("Show SnackBar"),
                ),
              );
            },
          ),
        );
      }
    }
    
    ```
    - `Builder` ìœ„ì ¯ì€ ìƒˆë¡œìš´ `BuildContext`ë¥¼ ìƒì„±í•˜ì—¬ ìƒìœ„ ì»¨í…ìŠ¤íŠ¸ì™€ ë¶„ë¦¬ëœ í™˜ê²½ì„ ì œê³µí•œë‹¤.
    - ì£¼ë¡œ `Scaffold.of(context)`ë‚˜ `Theme.of(context)` ê°™ì€ ë©”ì„œë“œ í˜¸ì¶œ ì‹œ ìƒìœ„ ìœ„ì ¯ì˜ ì»¨í…ìŠ¤íŠ¸ì— ì ‘ê·¼í•  ìˆ˜ ì—†ëŠ” ë¬¸ì œë¥¼ í•´ê²°í•˜ëŠ” ë° ì‚¬ìš©ëœë‹¤.
    - ë³µì¡í•œ ìœ„ì ¯ íŠ¸ë¦¬ì—ì„œ íŠ¹ì • ì»¨í…ìŠ¤íŠ¸ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ê´€ë¦¬í•  ë•Œ ìœ ìš©í•˜ë‹¤.
    - ì°¸ê³ ë¡œ `ScaffoldMessenger.of(context)` ë©”ì„œë“œë„ `context`ê°€ ë°˜ë“œì‹œ `Scaffold`ì˜ í•˜ìœ„ì— ìˆëŠ” ì»¨í…ìŠ¤íŠ¸ì—¬ì•¼ë§Œ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•œë‹¤.

# What if there were 2 Scaffolds?
```dart
import 'package:flutter/material.dart';

void main() {
  runApp(
    MaterialApp(
      home: MyHomePage(),
    ),
  );
}

class MyHomePage extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      backgroundColor: Color(0xFF1B5E20), // green
      body: Scaffold(
        backgroundColor: Color(0xffe91e63), // pink
        floatingActionButton: Builder(builder: (context) {
          return FloatingActionButton(onPressed: () {
            print(Scaffold.of(context).widget.backgroundColor); // Color(0xffe91e63), ì¦‰ pinkê°€ ì¶œë ¥ë¨
          });
        }),
      ),
    );
  }
}
```
- ë¶€ëª¨ Scaffoldê°€ ë‘ ê°œ ì´ìƒì¼ ê²½ìš° ê°€ì¥ ê°€ê¹Œìš´ Scaffoldê°€ ì „ë‹¬ëœë‹¤.
	![[ìœ„ì ¯ íŠ¸ë¦¬ ì˜ˆì‹œ 4.png|center|500]]
- Theme.of(context),Â MediaQuery.of(context),Â Navigator.of(context)Â andÂ Provider.of(context)ì™€ ê°™ì´ contextë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ëŠ” of í•¨ìˆ˜ê°€ ë§ì´ ì¡´ì¬í•œë‹¤.